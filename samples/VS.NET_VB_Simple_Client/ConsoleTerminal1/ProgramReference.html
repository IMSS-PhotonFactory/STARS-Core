<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
    <title>Console.Terminal1</title>
  </head>
  <body>
  <h1>ConsoleTerminal1 Reference</h1>
  <h1>Project Member</h1>
  <table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
<PRE>Solution 'ConsoleTerminal1'
 |
 +--+ Project 'ConsoleTerminal1'
    |
    +-- My Project
    |
    +-- Module1.vb
    |
    +-- app.config
</PRE>
  </td>
  </tr></table>
  &nbsp;
  <table border="1" cellspacing="0" >
    <tr valign="top" >
      <td rowspan=4>Properties of 'My Project'</td>
      <td >Reference - Reference Settings</td>
      <td colspan=3>StarsInterface.dll</td>
      <td >Directive for StarsInterface.<br>
        Add for using Stars .NET.</td>
    </tr>
    <tr valign="top" >
      <td rowspan=3>My Settings</td>
      <th >Name</th>
      <th >Type</th>
      <th >Scope</th>
      <th >Value</th>
    </tr>
    <tr valign="top" >
      <td >Nodename</td>
      <td >String</td>
      <td >Application</td>
      <td >Stars default nodename. Initial value is 'csterm'.
      <br>This value can be changed as you like.</td>
    </tr>
    <tr valign="top" >
      <td >StarsServer</td>
      <td >String</td>
      <td >Application</td>
      <td >Stars default hostname. Initial value is 'localhost'.
      <br>This value can be changed as you like.</td>
    </tr>
    <tr>
      <td rowspan=2>Program Files</td>
      <td ><a href="#Module1.vb">Module1.vb</a></td>
      <td colspan=4>Console Application Code</td>
    </tr>
    <tr>
      <td >app.config</a></td>
      <td colspan=4>This is a file auto-generated by My Settings.
      </td>
    </tr>
  </table>

  <hr>
  <h1><A NAME="Module1.vb">About Module1.vb</a><A></h1>
  <h3>Code View</h3>
  <table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
 <PRE>
Module Module1

    'Declare Stars Object
    Private stars As STARS.StarsInterface

    Sub Main()

        '!!See Project MySettings Property!! Default nodename and server
        '        Dim starsargs() As String = New String() {"csterm", "localhost"}
        Dim starsargs() As String = New String() {My.Settings.Nodename, My.Settings.StarsServer}

        ' Check Program Parameters
        Dim cmds As String() = System.Environment.GetCommandLineArgs()
        If (cmds.Length >= 3) Then
            starsargs(0) = cmds(1)
            starsargs(1) = cmds(2)
        ElseIf (cmds.Length = 2) Then
            starsargs(0) = cmds(1)
        End If

        ' Step1. Connect to Stars.
        stars = New STARS.StarsInterface(starsargs(0), starsargs(1))
        Try
            stars.Connect()
        Catch se As Exception
            Console.WriteLine(se.Message)
            Exit Sub
        End Try

        ' Step2. Add the stars handler named 'Stars_Message_Received' which is called when arriving stars messages via TCP/IP socket.
        stars.StartCbHandler(New STARS.StarsCbHandler(AddressOf Stars_Message_Received))

        ' Step3. Waiting for the input from console.
        ' until entering 'Quit' or 'Exit'.
        Console.WriteLine("Input Stars Message, for example 'System hello', or 'help' for help.")
        Dim buf As String
        While (True)
            buf = Console.ReadLine()
            If (buf.Trim.Equals("")) Then
                Continue While
            ElseIf (buf.ToUpper().Equals("QUIT")) Then
                Exit While
            ElseIf (buf.ToUpper().Equals("EXIT")) Then
                Exit While
            ElseIf (buf.ToUpper().Equals("HELP")) Then
                Console.WriteLine("Enter [help|quit|exit|'Stars Message to be sended']")
            Else
                Console.WriteLine("SEND#" + buf + "#")
				Try
	                stars.Send(buf)
                Catch se As Exception
                    Console.WriteLine(se.Message)
                    Exit While
	            End Try
            End If
        End While
    End Sub

    '
    ' This is Stars Handler called when arriving Stars Messages.
    '
    Private Sub Stars_Message_Received(ByVal sender As Object, ByVal cb As STARS.StarsCbArgs)
        Dim sendbuf As String
        If (cb.Message.Trim.Equals("")) Then
            ' No Message
            Console.WriteLine("RECV#{0}", cb.allMessage + "#")
            sendbuf = cb.from + " @" + cb.Message + " Er: Bad command."
            stars.Send(sendbuf)
            Console.WriteLine("RPLY#" + sendbuf)
        ElseIf (cb.command.StartsWith("@")) Then
            ' Begin with '@' : Reply's arrived
            Console.WriteLine("RECV#{0}", cb.allMessage)
        ElseIf (cb.command.StartsWith("_")) Then
            ' Begin with '_' : Event's arrived
            Console.WriteLine("EVNT#{0}", cb.allMessage)
        ElseIf (cb.to.Equals(stars.nodeName)) Then
            ' Command Request's arrived, to nodename
            Console.WriteLine("RECV#{0}", cb.allMessage + "#")
            If (cb.Message.Equals("hello")) Then
                sendbuf = cb.from + " @" + cb.Message + " hello nice to meet you"
                stars.Send(sendbuf)
                Console.WriteLine("RPLY#" + sendbuf)
            ElseIf (cb.Message.Equals("help")) Then
                sendbuf = cb.from + " @" + cb.Message + " hello help"
                stars.Send(sendbuf)
                Console.WriteLine("RPLY#" + sendbuf)
            Else
                sendbuf = cb.from + " @" + cb.Message + " Er: Bad command or parameter."
                stars.Send(sendbuf)
                Console.WriteLine("RPLY#" + sendbuf)
            End If
        Else
            ' Command Request's arrived, to nodename.XXXX... maybe
            Console.WriteLine("RECV#{0}", cb.allMessage + "#")
            sendbuf = cb.from + " @" + cb.Message + " Er: " + cb.to + " is down."
   	        stars.Send(sendbuf)
            Console.WriteLine("RPLY#" + sendbuf)
        End If
    End Sub
End Module
</PRE></td>
  </tr></table>

        <hr>
  <h1>Module <A NAME="Program">Module1</A></h1>
      Represents an Stars Console Application Main Module.<BR>
  For a list of all members of this type, see <a href="#Program Members">Module Members</a>.
        <hr>
        <h1><A NAME="Program Members"></A>Module Members</h1>
        <h4>Private Fields</h4>
        <table border="1" cellspacing="0">
<tr VALIGN="top"><td><a href="#Program.stars">stars</a></td>
<td>This field is a stars interface.</td>
</tr></table>
      <h4>Sub</h4>
        <table cellspacing="0" border="1">
<tr VALIGN="top"><td><a href="#Program.Main">Main</a></td>
<td>Here is Application Entrance.</td></tr>
<tr VALIGN="top"><td><a href="#Program.Stars_Message_Received">Stars_Message_Received</a></td>
<td>This method is called when arriving stars messages.</td>
</tr></table>
        <hr>
        <h1><A NAME="Program.stars">stars</A> Field</h1>
  <p>This field is a stars interface.</p>
            <h4>Usage</h4>
    Private&nbsp;stars&nbsp;As&nbsp;STARS.StarsInterface
        <hr>
            <h1><A NAME="Program.Main">Sub Main</A></h1>
        <p>Here is Application Entrance.</p>
        <h4>Usage</h4>
      Sub Main()
      <h4>Example</h4>
Example for Stars connection.
<table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
             <pre>Sub Main()
     ' Step1. Connect to Stars.
     stars = New STARS.StarsInterface(&quot;csterm&quot;, &quot;localhost&quot;)
     Try
         stars.Connect()
     Catch se As Exception
         Console.WriteLine(se.Message)
         Exit Sub
     End Try
    
     ' Step2. Add the stars handler named 'Stars_Message_Received' which is called when arriving stars messages via TCP/IP socket.
     stars.StartCbHandler(New STARS.StarsCbHandler(AddressOf Stars_Message_Received))
 
     ' Step3. Waiting for the input from console.
     Console.WriteLine("Input Stars Message or help.")
     Dim buf As String
     While (True)
         buf = Console.ReadLine()
         ' Add code for break...
     End While
}
</pre>
</td></tr></table>

        <hr>
        <h1><A NAME="Program.Stars_Message_Received">Sub Stars_Message_Received</A></h1>

      <p>This method is called when arriving stars messages.</p>
      <h4>Usage</h4>
      Private&nbsp;Sub&nbsp;Stars_Message_Received(ByVal&nbsp;sender&nbsp;As&nbsp;Object,&nbsp;ByVal&nbsp;cb&nbsp;As&nbsp;STARS.StarsCbArgs)
      <h4>Parameters</h4>
      <dl>
        <dt>
          <i>sender</i>
        </dt>
        <dd>
        </dd>
        <dt>
          <i>cb</i>
        </dt>
        <dd>Used to access the Stars object which contains received data.</dd>
      </dl>
      <h4>Example</h4>
<table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr><td><PRE>
Private Sub Stars_Message_Received(ByVal sender As Object, ByVal cb As STARS.StarsCbArgs)
    Dim sendbuf As String
    ' For check arriving &quot;hello&quot; 
    If (cb.Message.Equals("hello")) Then
        sendbuf = cb.from + " @" + cb.Message + " hello nice to meet you"
        ' Send Stars reply message to sender.
        stars.Send(sendbuf)
    End If
End Sub
</pre>
</td></tr></table>
  </body>
</html>
