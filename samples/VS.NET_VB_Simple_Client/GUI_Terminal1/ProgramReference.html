<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
    <title>GUI_Terminal1</title>
  </head>
  <body>
  <h1>GUI_Terminal1 Reference</h1>
  
  <h1>Project Member</h1>
  <table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
<PRE>Solution 'GUI_Terminal1'
 |
 +--+ Project 'GUI_Terminal1'
    |
    +-- My Project
    |
    +-- app.config
    |
    +-- Form1.vb
    |
    +-- Module1.vb
</PRE>
  </td>
  </tr></table>
  <BR>
  <table border="1" cellspacing="0" >
    <tr valign="top" >
      <td rowspan=5>Properties of 'My Project'</td>
      <td rowspan=2>Reference - Reference Settings</td>
      <td colspan=3>StarsInterface.dll</td>
      <td >Directive for StarsInterface.<br>
        Add for using Stars .NET.</td>
    </tr>
    <tr valign="top" >
      <td colspan=3>StarsInterfaceWinForm.dll</td>
      <td >Directive for StarsInterfaceWinForm.<br>
        Add for using Stars .NET.</td>
    </tr>
    <tr valign="top" >
      <td rowspan=3>My Settings</td>
      <th >Name</th>
      <th >Type</th>
      <th >Scope</th>
      <th >Value</th>
    </tr>
    <tr valign="top" >
      <td >Nodename</td>
      <td >String</td>
      <td >Application</td>
      <td >Stars default nodename. Initial value is 'csterm'.
      <br>This value can be changed as you like.</td>
    </tr>
    <tr valign="top" >
      <td >StarsServer</td>
      <td >String</td>
      <td >Application</td>
      <td >Stars default hostname. Initial value is 'localhost'.
      <br>This value can be changed as you like.</td>
    </tr>
    <tr>
      <td rowspan=3>Program Files</td>
      <td ><a href="#Program.cs">Module1.vb</a></td>
      <td colspan=4>Program Entry Point</td>
    </tr>
    <tr>
      <td ><a href="#Form1.cs">Form1.vb</a></td>
      <td colspan=4>Form1 Application Code</td>
    </tr>
    <tr>
      <td >app.config</a></td>
      <td colspan=4>This is a file auto-generated by My Settings.
      </td>
    </tr>
  </table>

  <hr>
  
  <h1>About <A NAME="Program.cs">Module1.vb</A></h1>
  <h3>Code View</h3>
  <table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
 <PRE>
Module Module1
    Public Sub Main()
        Dim MyForm1 As New <b><a href="#Form1.Form1">Form1()</a></b>
        System.Windows.Forms.Application.Run(MyForm1)
    End Sub
End Module
</PRE>


</td>
  </tr></table>

  <hr>
  <h1>About <A NAME="Form1.cs">Form1.vb</A></h1>
  <h3>Code View</h3>
  <table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td>
 <PRE>
Public Class Form1
    ' &lt;summary&gt;This field is a stars interface.&lt;/summary&gt;
    Public stars As STARS.StarsInterface

    ' Form1 Initialized here.
    Public Sub <a href="#Form1.Form1">New()</a>
        InitializeComponent()
        If (<a href="#Form1.Form1_Load">connect2stars()</a> = False) Then Exit Sub ' Calling connecting stars.
    End Sub

    ' &lt;summary&gt;Start Stars Connection here.&lt;/summary&gt;
    <a href="#Form1.Form1_Load">Private Function connect2stars() As Boolean</a>
        '!!See Project MySettings Property!! Default nodename and server
        '        Dim starsargs() As String = New String() {"csterm", "localhost"}
        Dim starsargs() As String = New String() {My.Settings.Nodename, My.Settings.StarsServer}

        ' Check Program Parameters
        Dim cmds As String() = System.Environment.GetCommandLineArgs()
        If (cmds.Length >= 3) Then
            starsargs(0) = cmds(1)
            starsargs(1) = cmds(2)
        ElseIf (cmds.Length = 2) Then
            starsargs(0) = cmds(1)
        End If

        ' Step1. Connect to Stars.
        stars = New STARS.StarsInterface(starsargs(0), starsargs(1))
        Try
            stars.Connect()
        Catch se As Exception
            MessageBox.Show(se.Message)
            Return False
        End Try

        ' Step2. Add the stars handler named 'stars_received' which is called when arriving stars messages.
        Dim cbStars As STARS.WinForm.StarsCbWinForm = New STARS.WinForm.StarsCbWinForm(Me, stars)
        cbStars.StartCbHandler(New STARS.StarsCbHandler(AddressOf <a href="#Form1.stars_received">stars_received</a>))
        Return True

    End Function

    ' &lt;summary&gt;This method is called when arriving stars messages.&lt;/summary&gt;
    <a href="#Form1.stars_received">Private Sub stars_received(ByVal sender As Object, ByVal ev As STARS.StarsCbArgs)</a>
        Dim mess As String

        If (ev.Message.Trim.Equals("")) Then
            ' No Message
            txtLog_update(ev.allMessage)
            logFile_update(ev.allMessage)
            mess = ev.from + " @" + ev.Message + " Er: Bad command."
            stars.Send(mess)
            txtLog_update(mess)
            logFile_update(mess)
        ElseIf (ev.command.StartsWith("@")) Then
            ' Begin with '@' : Reply's arrived
            lbReply_update(ev.allMessage)
            txtLog_update(ev.allMessage)
            logFile_update(ev.allMessage)
        ElseIf (ev.command.StartsWith("_")) Then
            ' Begin with '_' : Event's arrived
            txtLog_update(ev.allMessage)
            logFile_update(ev.allMessage)
        ElseIf (ev.to.Equals(stars.nodeName)) Then
            ' Command Request's arrived, to nodename
            txtLog_update(ev.allMessage)
            logFile_update(ev.allMessage)
            If (ev.Message.Equals("hello")) Then
                mess = ev.from + " @" + ev.Message + " hello nice to meet you."
            ElseIf (ev.Message.Equals("help")) Then
                mess = ev.from + " @" + ev.Message + " hello help."
            Else
                mess = ev.from + " @" + ev.Message + " Er: Bad command or parameter."
            End If
            stars.Send(mess)
            txtLog_update(mess)
            logFile_update(mess)
        Else
            ' Command Request's arrived, to nodename.XXXX... maybe
            txtLog_update(ev.allMessage)
            logFile_update(ev.allMessage)
            mess = ev.from + " @" + ev.Message + " Er: " + ev.to + " is down."
            stars.Send(mess)
            txtLog_update(mess)
            logFile_update(mess)
        End If
    End Sub

    ' &lt;summary&gt;Send button click method&lt;/summary&gt;
    <a href="#Form1.btSend_Click">Private Sub btSend_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btSend.Click</a>
        Dim mess As String
        Dim si As Integer
        
        mess = cbSend.Text
        If (mess.Trim.Equals("")) Then Exit Sub

        txtLog_update(mess)
        logFile_update(mess)
        lbReply_update("")

        Try
            stars.Send(mess)
        Catch se As Exception
            MessageBox.Show(se.Message);
            Exit Sub
        End Try

        si = cbSend.FindString(mess, -1)
        If (si < 0) Then
            cbSend.Items.Add(mess)
        Else
            cbSend.Items.RemoveAt(si)
            cbSend.Items.Add(mess)
            cbSend.SelectedItem = mess
        End If
    End Sub

	' *** The rest is omitted. show program source file.
End Class
</PRE></td>
  </tr></table>

  <hr>

  <h1><A NAME="ProgramForm1">Form1</A>  Class</h1>
  Form1 class.<BR>
  For a list of all members of this type, see <a href="#ProgramForm1 Members">Form1 Members.</a>
  <p>Public Class Form1&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; Form</p>
        <h1><A NAME="ProgramForm1 Members"></A>Form1 Members</h1>
        <h4>
        Public Fields</h4>
        <table border="1" cellspacing="0">
<tr VALIGN="top"><td><a href="#Form1.stars">stars</a></td>
<td>This field is a stars interface.</td>
</tr></table>
  <h4>Form1 Constructors</h4>
        <table cellspacing="0" border="1">
<tr>
  <td><a href="#Form1.Form1">New</a></td>
<td>Form1 Initialized here.</td>
</tr>
  </table>
      <p><b>Private Methods</b></p>
        <table cellspacing="0" border="1">
<tr VALIGN="top"><td><a href="#Form1.Form1_Load">connect2stars</a></td>
<td>Start stars connection here.</td></tr>
<tr>
  <td><a href="#Form1.stars_received">stars_received</a></td>
<td>This method is called when arriving stars messages.</td>
</tr>
<tr VALIGN="top"><td><a href="#Form1.btSend_Click">btSend_Click</a></td>
<td>Send button click method. Send stars message.</td>
</tr></table>
        <h1><A NAME="Form1.stars">Form1.stars</A> Field</h1>
  <p>This field is a stars interface.</p>
            <h4>Usage</h4>
  <p>Public stars As STARS.StarsInterface</p>
  <h1><A NAME="Form1.Form1">Form1</A>  Constructor</h1>
  <p>Form1 Initialized here.</p>
            <h4>Usage</h4>
  <p>New Form1()</p>
  <h1><A NAME="Form1.Form1_Load">connect2stars</A> Method&nbsp;</h1>
  <p>Start stars connection here.</p>
        <h4>Usage</h4>
Private Function connect2stars() As Boolean
      <h4>Example</h4>
  <p>Example for Stars connection.</p>
<table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr>
  <td><pre>Private Function connect2stars() As Boolean
     ' Step1. Connect to Stars.
     stars = New STARS.StarsInterface(&quot;csterm&quot;, &quot;localhost&quot;)
     Try
         stars.Connect()
     Catch se As Exception
         MessageBox.Show(se.Message);
         Return False
     End Try
    
     ' Step2. Add the stars handler named 'Stars_Message_Received' which is called when arriving stars messages via TCP/IP socket.
     StarsCbWinForm cbStars = new StarsCbWinForm(this, stars);
     cbStars.StartCbHandler(new StarsCbHandler(stars_received));
     Return True
End Function
</pre>

</td></tr></table>

        <h1><A NAME="Form1.stars_received">Form1.stars_received</A>&nbsp;Method</h1>

      <p>This method is called when arriving stars messages.</p>
      <h4>Usage</h4>
      Private Sub stars_received(ByVal <i>sender</i> As Object, ByVal <i>ev</i> As STARS.StarsCbArgs)</a>
      <h4>Parameters</h4>
      <dl>
        <dt>
          <i>sender</i>
        </dt>
        <dd>
        </dd>
        <dt>
          <i>ev</i>
        </dt>
        <dd>Used to access the Stars object which contains received data.</dd>
      </dl>
      <h4>Example</h4>
      <p>Example for receive message to Stars Server.</p>
<table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr><td><PRE>
Private Sub stars_received(ByVal sender As Object, ByVal ev As STARS.StarsCbArgs)
   If (ev.to.Equals(stars.nodeName)) Then
       ' Command Request's arrived, to nodename
       If (ev.Message.Equals("hello")) Then
       'For check arriving &quot;hello&quot; 
           ' Send Stars reply message to sender.
           stars.Send(cb.from + &quot; @&quot; + cb.Message &quot; hello nice to meet you&quot;);
       End If
End Sub
</pre>
</td></tr></table>
  <h1>Form1.<A NAME="Form1.btSend_Click">btSend_Click</A>&nbsp;Method</h1>

      <p>Send button click method. Send stars message.</p>
      <h4>Usage</h4>
  Private Sub btSend_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btSend.Click
      <h4>Example</h4>
  <p>Example for send message to Stars Server.</p>
<table width="70%" border="0" cellpadding="4" cellspacing="0" bgcolor="#e8e8e8">
  <tr><td><PRE>
Private Sub btSend_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btSend.Click
        Dim mess As String
        mess = &quot;System hello&quot;;
        Try
            stars.Send(mess)
        Catch se As Exception
            MessageBox.Show(se.Message);
            Exit Sub
        End Try
End Sub
</pre>
</td></tr></table>
  </body>
</html>
